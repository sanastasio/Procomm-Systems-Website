// Unify - Settings
// Developed for Unify by Unit Interactive
// unify.unitinteractive.com
//
// Built on jQuery - jquery.com

var un1fyGlobalPath=null;var un1fyPath=null;var un1fyHTMLEdit=null;var un1fyFiles=null;var un1fyFilePath=null;var un1fyImagePath=null;$(function(){unifySetup();$(window).bind("resize",windowResize);$("#logout a").bind("click",logout);$("#un1fyPrefBtn").bind("click",savePrefs);$("#un1fyFTPBtn").bind("click",saveFTP);$("#un1fyFTPClearBtn").bind("click",clearFTPPrompt);$("#un1fyNewUserLink").bind("click",newUser);$("#un1fyNewUserCancel").bind("click",newUserCancel);$("#un1fyDashScrollWrap").height($(window).height()-60);$("#un1fyAutoUpdate").bind("click",autoUpdatePrompt);$("#un1fyMessage").bind("keyup",function(){if(getNoLines(this)>parseInt(this.rows)){this.rows=""+Math.round(parseInt(this.rows)*1.2)}})});var unifySetup=function(){$("#un1fyTopBanner").css("background","url(../unify-images/loading.gif) repeat-x bottom");var e;try{e=document.createElement('<iframe name="un1fyPrefsFrame" >')}catch(t){e=document.createElement("iframe")}$(e).attr({id:"un1fyPrefsFrame",name:"un1fyPrefsFrame",src:"../functions/getsaveprefs.php",application:"yes"}).css("display","none");$("body").append(e)};var getGlobals=function(e,t,n,r,i,s){var o=window.location.href.split("/"+e+"/");un1fyGlobalPath=o[0]+"/"+e;un1fyPath=e;un1fyHTMLEdit=t;un1fyFiles=n;un1fyFilePath=r;un1fyImagePath=s;un1fyExFolders=i;changePrefs()};var savePrefs=function(){var e=$("input[name=htmltoggle]:checked").val();$("#un1fyTopBanner").css("background","url(../unify-images/loading.gif) repeat-x bottom");var t;try{t=document.createElement('<iframe name="un1fySavePrefsFrame" >')}catch(n){t=document.createElement("iframe")}$(t).attr({id:"un1fySavePrefsFrame",name:"un1fySavePrefsFrame",application:"yes"}).css("display","none");$("body").append(t);$("#un1fyPrefsForm")[0].submit()};var changePrefs=function(){var e=e=window.location.href;var t=e.split("//");t=t[1];$("#un1fyPath").empty();var n=e.split("settings/");n=n[0];$("#un1fyPath").html(n);if(un1fyHTMLEdit=="Y"){$("#htmltoggleon").prop("checked",true);$("#htmltoggleoff").prop("checked",false)}else{$("#htmltoggleoff").prop("checked",true);$("#htmltoggleon").prop("checked",false)}if(un1fyFiles=="Y"){$("#filetoggleon").prop("checked",true);$("#filetoggleoff").prop("checked",false)}else{$("#filetoggleoff").prop("checked",true);$("#filetoggleon").prop("checked",false)}if(un1fyFilePath!=""){$("#un1fyFilePath").val(un1fyFilePath)}if(un1fyImagePath!=""){$("#un1fyImagePath").val(un1fyImagePath)}if(un1fyExFolders!=""){$("#un1fyExFolders").val(un1fyExFolders)}$("#un1fyPrefsFrame, #un1fySavePrefsFrame").remove();if($("#un1fyAcctFormSuperAdmin").length){unifyUsers()}else{$("#un1fyTopBanner").css("background","none")}twitterFeed()};var logout=function(){$.ajax({type:"POST",url:"../functions/logout.php",success:function(){window.location="../../"}})};var showPrompt=function(){$("#un1fyPrompt:hidden").css({display:"block",opacity:"0"}).fadeTo(300,1,function(){if($.browser.msie){$(this)[0].style.removeAttribute("filter")}})};var unifyPromptTop=function(){$("<div/>").attr("id","un1fyPromptTop").appendTo("#un1fyPrompt").append($("<img/>").attr({src:"../unify-images/img_upload_select_top.png",height:"10",width:"353",alt:"top"}))};var unifyPromptBot=function(){$("<div/>").attr("id","un1fyPromptBot").appendTo("#un1fyPrompt").append($("<img/>").attr({src:"../unify-images/img_upload_select_bottom.png",height:"10",width:"353",alt:"top"}))};var cancel=function(){if($("#un1fyPromptWrap").length>0){$("#un1fyPromptWrap").remove()}$("#overlay").fadeTo(300,0,function(){$("#overlay").remove()})};var windowResize=function(){if($("#overlay").length){$("#overlay").css({width:$(window).width(),height:$(window).height()})}};var overlay=function(e){$("<div/>").attr("id","overlay").height($(document).height()).width($(document).width()).appendTo("body").css({display:"block",opacity:"0"}).fadeTo(300,.55)};var userBar=function(e){if($("#un1fyPrompt").length){cancel()}$("#un1fyTopBanner").css("background","none");if(!$("#un1fyUserBar").length){$("<div/>").addClass("un1fyUserBar").attr("id","un1fyUserBar").insertAfter("#un1fyTopBanner").append($("<div/>").addClass("un1fyUserBarIn").attr("id","un1fyUserBarIn").append($("<a/>").attr("href","javascript:").html("Hide This Bar").bind("click",hideUserBar)).append($("<p/>")));if(e.match(/successfully/gi)){$("#un1fyUserBar").find("p").html("<strong>"+e+"</strong>").end().css("opacity","0.4").animate({opacity:"1"},800);var t=setTimeout(function(){$("#un1fyUserBar").animate({opacity:"0"},300,function(){$("#un1fyUserBar").remove()})},3500)}else{$("#un1fyUserBar").find("p").html(e).end().hide().css({opacity:"1.0",backgroundColor:"#c6242b",position:"relative",top:"0",left:"0"}).slideDown(300)}}else{$("#un1fyUserBar").remove();window.clearTimeout(t);userBar(e)}if($("#un1fyNewUser").css("display")=="block"){$("#un1fyNewUser").find("input").val("").end().find("input:first").focus()}};var hideUserBar=function(){if($("#un1fyUserBar").css("position")=="relative"){$("#un1fyUserBar").animate({marginTop:"-26px"},300,function(){$("#un1fyUserBar").remove()})}else{$("#un1fyUserBar").animate({opacity:"0"},200,function(){$("#un1fyUserBar").remove()})}};var v=0;var unifyUsers=function(){var e;try{e=document.createElement('<iframe name="un1fyUsersFrame" >')}catch(t){e=document.createElement("iframe")}$(e).attr({id:"un1fyUsersFrame",name:"un1fyUsersFrame",src:"../functions/getsaveusers.php",application:"yes"}).css("display","none");$("body").append(e)};var adminUser=function(e,t,n){$("#un1fyAcctFormSuperAdmin").find("h3").html(e+" <strong>Admin</strong>").prepend($("<span/>").append($("<a/>").addClass("un1fyAcctModify").attr({href:"javascript:",title:"edit your login information"}).html("modify"))).end().find(".un1fyAcctUserLi input").val(t).end().find(".un1fyAcctEmailLi input").val(n);$("#un1fyAcctFormSuperAdmin a.un1fyAcctModify").unbind("click").bind("click",userModify)};var buildUser=function(e,t,n,r){if(e&&t&&n){if(!$("#user"+r).length){var i='<div id="user'+r+'" class="un1fyDashElement">'+'<form class="un1fyAcctForm un1fyAcctDisplay" action="../functions/getsaveusers.php" method="post" target="un1fySaveUserFrame" >'+"<h3></h3>"+"<ul>"+'<li class="un1fyAcctUserLi">'+"<label>Username </label>"+'<input class="un1fyLocked un1fyAcctUser" name="un1fyAcctUser" type="text" value="" readonly="true" />'+'<input class="un1fyLocked un1fyAcctUser-orig" name="un1fyAcctUser-orig" type="hidden" value="" readonly="true" />'+"</li>"+'<li class="un1fyAcctPassLi">'+"<label>Password </label>"+'<input id="un1fyAcctPass" class="un1fyLocked un1fyAcctPass" name="un1fyAcctPass" type="text" value="TOTALLY SECURE, REALLY" readonly="true" />'+"</li>"+"</ul>"+'<ul class="un1fyAcctMeta">'+'<li class="un1fyAcctEmailLi">'+"<label>Email </label>"+'<input class="un1fyLocked un1fyAcctEmail" name="un1fyAcctEmail" type="text" value="" readonly="true" />'+'<input class="un1fyLocked un1fyAcctEmail-orig" name="un1fyAcctEmail-orig" type="hidden" value="" readonly="true" />'+"</li>"+"</ul>"+"</form>"+"</div>";$userArea=$(i);$userArea.find("h3").html(e).prepend($("<span/>").append($("<a/>").addClass("un1fyAcctModify").attr({href:"javascript:",title:"edit this user"}).html("modify")).append("|").append($("<a/>").addClass("un1fyAcctDelete").attr({href:"javascript:",title:"delete this user"}).html("delete"))).end().find(".un1fyAcctUserLi input").val(t).end().find(".un1fyAcctEmailLi input").val(n);$userArea.find("a.un1fyAcctModify").bind("click",userModify).end().find("a.un1fyAcctDelete").bind("click",function(){userDeletePrompt(this)}).end().insertAfter(".un1fyDashElement:last")}else{$("#user"+r).find("h3").html(e).prepend($("<span/>").append($("<a/>").addClass("un1fyAcctModify").attr({href:"javascript:",title:"edit this user"}).html("modify")).append("|").append($("<a/>").addClass("un1fyAcctDelete").attr({href:"javascript:",title:"delete this user"}).html("delete"))).end().find(".un1fyAcctUserLi input").val(t).end().find(".un1fyAcctEmailLi input").val(n).end().find("a.un1fyAcctModify").unbind("click").bind("click",userModify).end().find("a.un1fyAcctDelete").unbind("click").bind("click",function(){userDeletePrompt(this)})}}};var removeFrames=function(){$("#un1fyUsersFrame, #un1fySaveUserFrame, #un1fyDelUserFrame, #un1fySaveFTPFrame, #un1fyClearFTPFrame").remove();$("#un1fyTopBanner").css("background","none");cancel()};var newUser=function(){userModifyCancel();$("#un1fyNewUser").css("display","block").find("input:first").focus().end().find("#un1fyAcctFormNewUser").addClass("un1fyNewAcctEditing").end().find("#un1fyNewUserSave").bind("click",userModifySave);$("#un1fyNewUserLink").unbind("click").bind("click",newUserCancel);$("#un1fyNewAcctPass").unbind("keyup").bind("keyup",function(){runPassword(this)});setTimeout(function(){$("#un1fyNewName").focus()},0)};var newUserCancel=function(){$("#un1fyNewUser").css("display","none").find("input").val("");$("#pwStrengthNew").removeClass().html('n/a <span class="advice">&ldquo;Medium&rdquo; or &ldquo;strong&rdquo; required.</span>');$("#un1fyNewUserLink").unbind("click",newUserCancel).bind("click",newUser)};var userModify=function(){newUserCancel();if(!$(".un1fyAcctPassConLi").length){$(this.parentNode.parentNode.parentNode).addClass("un1fyAcctEditing").find("input").removeAttr("readonly").removeClass("un1fyLocked").addClass("un1fyUnlocked").end().find(".un1fyAcctUserLi").append($("<span/>").addClass("error").html("Please create a username")).end().find(".un1fyAcctPassLi").append($("<span/>").addClass("error").html("&ldquo;Medium&rdquo; or &ldquo;strong&rdquo; required.")).after($("<li/>").addClass("un1fyAcctPassConLi").append($("<label/>").html("Confirm Password")).append($("<input/>").addClass("un1fyUnlocked un1fyAcctPassCon").attr({name:"un1fyAcctPassConfirm",type:"password"})).append($("<span/>").addClass("error").html("Must match password"))).after($("<li/>").addClass("un1fyAcctPassInfo").attr("id","pwStrength").html('n/a <span class="advice">&ldquo;Medium&rdquo; or &ldquo;strong&rdquo; required. Leave blank if you don&rsquo;t want a new password.</span>')).end().find(".un1fyAcctPassLi label").html("New Password ").end().find(".un1fyAcctPassLi input").replaceWith($("<input/>").attr("id","un1fyAcctPass").addClass("un1fyUnlocked un1fyAcctPass").attr({type:"password",name:"un1fyAcctPass"}).val("")).end().find(".un1fyAcctEmailLi").append($("<span/>").addClass("error").html("Please enter a valid email")).end().find(".un1fyAcctMeta").append($("<li/>").addClass("un1fyFormSave").append($("<a/>").addClass("userSave").attr({href:"javascript:",title:"save"}).html("save").bind("click",userModifySave)).append($("<span/>").addClass("un1fyCancel").html("or ").append($("<a/>").attr("href","javascript:").html("cancel").bind("click",userModifyCancel))))}$("#un1fyAcctPass").unbind("keyup").bind("keyup",function(){runPassword(this)});$("a.un1fyAcctModify").unbind("click",userModify).bind("click",userModifyCancel);$("#un1fyAcctFormSuperAdmin .un1fyAcctUser input:first").focus()};var userModifySave=function(){if(userModifyValid()){$("#un1fyTopBanner").css("background","url(../unify-images/loading.gif) repeat-x bottom");var e;try{e=document.createElement('<iframe name="un1fySaveUserFrame" >')}catch(t){e=document.createElement("iframe")}$(e).attr({id:"un1fySaveUserFrame",name:"un1fySaveUserFrame",application:"yes"}).css("display","none");$("body").append(e);$(this).parents(".un1fyAcctForm")[0].submit();userModifyCancel()}};var userModifyValid=function(e){$(".un1fyAcctEditing li.error").removeClass("error");if(e){validCheck(e)}else{var t=0;var n=$(".un1fyAcctEditing input, .un1fyNewAcctEditing input").not(".un1fyAcctUser-orig, .un1fyAcctEmail-orig");n.each(function(){if(validCheck(this)){t++}});$(".un1fyAcctEditing input, .un1fyNewAcctEditing input").not(".un1fyAcctUser-orig, .un1fyAcctEmail-orig").unbind("change").bind("change",function(){validCheck(this)});if(t==n.length){return true}}};var validCheck=function(e){var t=/^[a-zA-Z0-9,!#\$%&'\*\+\/=\?\^_`\{\|}~-]+(\.[a-z0-9,!#\$%&'\*\+\/=\?\^_`\{\|}~-]+)*@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,4}$/;var n=/^\w*(?=\w*\d)(?=\w*[a-z])(?=\w*[A-Z])\w{5,}$/;var r=false;var i=$(e).val();var s=$(e).attr("class");var o=$(e).parent();if(s.match(/un1fyAcctEmail/g)){if(t.test(i)==true){r=true;o.removeClass("error")}else{o.addClass("error")}}else if(s.match(/un1fyAcctPass\b/)){if($(e).parents(".un1fyAcctEditing").length){if($("#pwStrength").attr("class").match(/strong|medium/)||i==""){r=true;o.removeClass("error")}else{o.addClass("error")}}else{if($("#pwStrengthNew").attr("class").match(/strong|medium/)){r=true;o.removeClass("error")}else{o.addClass("error")}}}else if(s.match(/un1fyAcctPassCon/)){if($(e).parents(".un1fyAcctEditing").length){if(i==$(".un1fyAcctPass",".un1fyAcctEditing").val()){r=true;o.removeClass("error")}else{o.addClass("error")}}else{if(i==$(".un1fyAcctPass",".un1fyNewAcctEditing").val()){r=true;o.removeClass("error")}else{o.addClass("error")}}}if(s.match(/un1fyFTPServer/g)){r=true;o.removeClass("error")}else{if(i!=""){r=true;o.removeClass("error")}else{o.addClass("error")}}return r};var userModifyCancel=function(){$(".un1fyAcctEditing li.error").removeClass("error");$(".un1fyAcctEditing").removeClass("un1fyAcctEditing").find(".un1fyAcctPassInfo").remove().end().find(".un1fyAcctPassLi label").html("Password ").end().find(".un1fyAcctPassLi input").replaceWith($("<input/>").addClass("un1fyLocked").attr({type:"text",name:"un1fyAcctPass"}).val("TOTALLY SECURE, REALLY")).end().find("#pwStrength").remove().end().find("input").removeClass("un1fyUnlocked").addClass("un1fyLocked").attr("readonly","true").end().find(".un1fyAcctPassConLi").remove().end().find(".un1fyFormSave").remove().end().find("li span").remove();$("#un1fyAcctPass").unbind("keyup");$("a.un1fyAcctModify").unbind("click",userModifyCancel).bind("click",userModify)};var userDeletePrompt=function(e){overlay();if(!$("#un1fyPrompt").length){$("body").append($("<div/>").attr("id","un1fyPromptWrap").load("../unify-temps/prompt.html",function(){$("#un1fyPrompt h4.un1fyPromptTitle").html("Delete User");$("#un1fyPrompt p").html("Are you sure you want to delete this user? You cannot undo this action.");$("#un1fyPromptBtn").addClass("un1fyDeleteBtn").attr("title","delete this user").html("delete").bind("click",function(){var t=$(e).parents(".un1fyDashElement").attr("id").replace("user","");userDelete(t)});$("#un1fyCancelBtn").bind("click",cancel);showPrompt()}))}};var userDelete=function(e){$(".un1fyDashElement").not("#un1fySuperAdmin").each(function(){$("#user"+e).remove()});var t;try{t=document.createElement('<iframe name="un1fyDelUserFrame" >')}catch(n){t=document.createElement("iframe")}$(t).attr({id:"un1fyDelUserFrame",name:"un1fyDelUserFrame",src:"../functions/getsaveusers.php?un1fyDelUser="+e,application:"yes"}).css("display","none");$("body").append(t)};var getNoLines=function(e){var t=e.value.split("\n");var n=t.length;for(var r=0,i=t.length;r<i;r++){n+=Math.max(Math.round(t[r].length/e.cols),1)-1}return n};String.prototype.strReverse=function(){var e="";for(var t=0;t<this.length;t++){e=this.charAt(t)+e}return e};var checkPassword=function(e){var t=0,n=0,r=0,i=0,s=0,o=0,u=0,a=0,f=0,l=0,c=0,h=0,p=0,d=0,v=0,m=0,g=0,y=0,b=4,w=4,E=6,S=2,x=2,T=2,N=2,C=3,k=3,L="",A="",O="",M="",_="abcdefghijklmnopqrstuvwxyz",D="01234567890";t=parseInt(e.length*b);n=e.length;var P=e.replace(/\s+/g,"").split(/\s*/),H=P.length;for(var B=0;B<H;B++){if(P[B].match(new RegExp(/[A-Z]/g))){if(L!==""){if(L+1==B){c++;v++}}L=B;r++}else if(P[B].match(new RegExp(/[a-z]/g))){if(A!==""){if(A+1==B){h++;v++}}A=B;i++}else if(P[B].match(new RegExp(/[0-9]/g))){if(B>0&&B<H-1){u++}if(O!==""){if(O+1==B){p++;v++}}O=B;s++}else if(P[B].match(new RegExp(/[^a-zA-Z0-9_]/g))){if(B>0&&B<H-1){u++}if(M!==""){if(M+1==B){d++;v++}}M=B;o++}for(var j=0;j<H;j++){if(P[B].toLowerCase()==P[j].toLowerCase()&&B!=j){l++}}}for(var F=0;F<23;F++){var I=_.substring(F,parseInt(F+3));var q=I.strReverse();if(e.toLowerCase().indexOf(I)!=-1||e.toLowerCase().indexOf(q)!=-1){m++;y++}}for(var F=0;F<8;F++){var I=D.substring(F,parseInt(F+3));var q=I.strReverse();if(e.toLowerCase().indexOf(I)!=-1||e.toLowerCase().indexOf(q)!=-1){g++;y++}}if(r>0&&r<n){t=parseInt(t+(n-r)*2);sAlphaUC="+ "+parseInt((n-r)*2)}if(i>0&&i<n){t=parseInt(t+(n-i)*2);sAlphaLC="+ "+parseInt((n-i)*2)}if(s>0&&s<n){t=parseInt(t+s*w);sNumber="+ "+parseInt(s*w)}if(o>0){t=parseInt(t+o*E);sSymbol="+ "+parseInt(o*E)}if(u>0){t=parseInt(t+u*S);sMidChar="+ "+parseInt(u*S)}if((i>0||r>0)&&o===0&&s===0){t=parseInt(t-n);a=n;sAlphasOnly="- "+n}if(i===0&&r===0&&o===0&&s>0){t=parseInt(t-n);f=n;sNumbersOnly="- "+n}if(l>0){t=parseInt(t-l*l);sRepChar="- "+l}if(c>0){t=parseInt(t-c*x);sConsecAlphaUC="- "+parseInt(c*x)}if(h>0){t=parseInt(t-h*T);sConsecAlphaLC="- "+parseInt(h*T)}if(p>0){t=parseInt(t-p*N);sConsecNumber="- "+parseInt(p*N)}if(m>0){t=parseInt(t-m*C);sSeqAlpha="- "+parseInt(m*C)}if(g>0){t=parseInt(t-g*k);sSeqNumber="- "+parseInt(g*k)}return t};var runPassword=function(e){var t=checkPassword(e.value);var n;var r;var i;if(t<0){t=0}else if(t>100){t=100}if(t>=60){n="strong";r=n+" ("+t+"%)";i="Great password! Now just confirm in the next field."}else if(t>=30&&t<=59){n="medium";r=n+" ("+t+"%)";i="That will do! Now just confirm in the next field."}else{r=n="weak";r=n+" ("+t+"%)";i="&ldquo;Medium&rdquo; or &ldquo;strong&rdquo; required. Varied lettercase, numbers, & special characters help."}if($(e).val()==""){$("#pwStrength").removeClass().html('n/a <span class="advice">&ldquo;Medium&rdquo; or &ldquo;strong&rdquo; required. Leave blank if you don&rsquo;t want a new password.</span>');if($(e).parents("#un1fyAcctFormNewUser").length){$("#pwStrengthNew").removeClass().html('n/a <span class="advice">&ldquo;Medium&rdquo; or &ldquo;strong&rdquo; required.</span>')}}else{var s=$(e).parents("#un1fyAcctFormNewUser").length?"#pwStrengthNew":"#pwStrength";$(s).removeClass().addClass(n).html(r+' <span class="advice">'+i+"</span>")}};var countContain=function(e,t){var n=0;for(i=0;i<e.length;i++){if(t.indexOf(e.charAt(i))>-1){n++}}return n};var formatTweet=function(e){var t=e.match(/http[^\s]+/gi);if(t){for(var n=0;n<t.length;n++){e=e.replace(t[n],'<a href="'+t[n]+'">'+t[n]+"</a>")}}var r=e.match(/^@[^\s]+|\s@[^\s]+\b/gi);if(r){for(var n=0;n<r.length;n++){r[n]=r[n].replace(" ","");r[n]=r[n].replace(":","");var i=r[n].replace(/@/,"");e=e.replace(r[n],'@<a href="http://twitter.com/'+i+'">'+i+"</a>")}}var s=e.match(/#[^\s]+/gi);if(s){for(var n=0;n<s.length;n++){s[n]=s[n].replace(" ","");s[n]=s[n].replace(":","");var o=s[n].replace(/#/,"");e=e.replace(s[n],'#<a href="http://twitter.com/search?q=#'+o+'">'+o+"</a>")}}return e};var formatTweetDate=function(e){var t=e.split(" ");switch(t[1]){case"Jan":t[1]="00";break;case"Feb":t[1]="01";break;case"Mar":t[1]="02";break;case"Apr":t[1]="03";break;case"May":t[1]="04";break;case"Jun":t[1]="05";break;case"Jul":t[1]="06";break;case"Aug":t[1]="07";break;case"Sep":t[1]="08";break;case"Oct":t[1]="09";break;case"Nov":t[1]="10";break;case"Dec":t[1]="11";break}t=new Date(t[5],t[1],t[2]);return t.getMonth()+1+"/"+t.getDay()+"/"+t.getFullYear()+" - "};var twitterFeed=function(){$.ajax({type:"GET",crossDomain:true,url:"http://api.twitter.com/statuses/user_timeline/unifysupport.json?count=100&exclude_replies",dataType:"jsonp",success:function(e){var t="";var n=0;$(e).each(function(r){var i=this.text;var s=this.created_at;if(!i.match(/^@/gi)){n++;t+="<li>"+formatTweetDate(s)+formatTweet(i)+"</li>";if(n==5||r==e.length-1){$("#twitter_update_list").html(t);return false}}})}})};var saveFTP=function(){if(FTPvalid()){$("#un1fyTopBanner").css("background","url(../unify-images/loading.gif) repeat-x bottom");var e;try{e=document.createElement('<iframe name="un1fySaveFTPFrame" >')}catch(t){e=document.createElement("iframe")}$(e).attr({id:"un1fySaveFTPFrame",name:"un1fySaveFTPFrame",application:"yes"}).css("display","none");$("body").append(e);$("#un1fyFTPForm")[0].submit()}};var clearFTPPrompt=function(e){overlay();if(!$("#un1fyPrompt").length){$("body").append($("<div/>").attr("id","un1fyPromptWrap").load("../unify-temps/prompt.html",function(){$("#un1fyPrompt h4.un1fyPromptTitle").html("Clear FTP Info");$("#un1fyPrompt p").html("Are you sure you want to clear your FTP info? You cannot undo this.");$("#un1fyPromptBtn").addClass("un1fyPromptBtn").attr("title","clear").html("clear").bind("click",function(){clearFTP()});$("#un1fyCancelBtn").bind("click",cancel);showPrompt()}))}};var clearFTP=function(){$("#un1fyTopBanner").css("background","url(../unify-images/loading.gif) repeat-x bottom");var e;try{e=document.createElement('<iframe name="un1fyClearFTPFrame" >')}catch(t){e=document.createElement("iframe")}$(e).attr({id:"un1fyClearFTPFrame",name:"un1fyClearFTPFrame",application:"yes",src:"../functions/ftpclear.php"}).css("display","none");$("body").append(e)};var clearFTPInfo=function(){$("#un1fyFTPForm input").val("")};var FTPvalid=function(e){e=e||false;$("#un1fyFTPForm li.error").removeClass("error");if(e){validCheck(e)}else{var t=0;var n=$("#un1fyFTPForm input");n.each(function(){if(validCheck(this)){t++}});$("#un1fyFTPForm input").unbind("change").bind("change",function(){validCheck(this)});if(t==n.length){return true}}};var autoUpdatePrompt=function(){overlay();if(!$("#un1fyPrompt").length){$("body").append($("<div/>").attr("id","un1fyPromptWrap").load("../unify-temps/prompt.html",function(){$("#un1fyPrompt h4.un1fyPromptTitle").html("Auto-Update Unify");$("#un1fyPrompt p").addClass("simple").html("Are you sure you want to update? Your preferences, FTP info, and restore states will be preserved. You cannot undo or cancel once you start the auto-update process. It should take less than 3 minutes.");$("#un1fyPromptBtn").addClass("un1fyPromptBtn").attr("title","Auto-update unify to the latest version").html("update").bind("click",autoUpdate);$("#un1fyCancelBtn").bind("click",cancel);showPrompt()}))}};var autoUpdate=function(){$("#un1fyTopBanner").css("background","url(../unify-images/loading.gif) repeat-x bottom");$("#un1fyPrompt h4.un1fyPromptTitle").html("Auto-Updating&hellip; Please Wait");$("#un1fyPrompt p").html("Uploading the new files now. Please do not refresh your browser or stop loading.");$("#un1fyPromptBtn,#un1fyCancelBtn").remove();var e;try{e=document.createElement('<iframe name="un1fyUpdateFrame" >')}catch(t){e=document.createElement("iframe")}$(e).attr({id:"un1fyUpdateFrame",name:"un1fyUpdateFrame",application:"yes",src:"../functions/updatestart.php"}).css("display","none");$("body").append(e)};var autoUpdateSuccess=function(){$("#un1fyPrompt h4.un1fyPromptTitle").html("Auto-Update was Successful!");$("#un1fyPrompt p").html("You are now updated to the latest version of Unify. Please click &ldquo;done&rdquo;.");$("#un1fyPromptInsert").append($("<a/>").attr({id:"un1fyPromptBtn",href:"javascript:"}).addClass("un1fyPromptBtn").attr("title","Start using the latest Unify!").html("done").bind("click",reloadPage))};var reloadPage=function(){window.location.reload(true);window.location.reload(true)}
